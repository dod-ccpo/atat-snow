<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_g_dis_atat.MultipartHelper</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description>A class that helps with generating multiparts</description>
        <name>MultipartHelper</name>
        <script><![CDATA[var MultipartHelper = Class.create();
MultipartHelper.prototype = {
    initialize: function() {
    },
    createBody: function(packageSysId, attachmentDocSysId) {
		var endpoint = gs.getProperty("glide.servlet.uri") + "api/x_g_dis_atat/edms/edms-multipart-attachment";

		var internalRequest = new sn_ws.RESTMessageV2();
		internalRequest.setEndpoint(endpoint);
		internalRequest.setHttpMethod("GET");
		internalRequest.setRequestHeader("Accept", "multipart/form-data");
		internalRequest.setBasicAuth(
            gs.getProperty("x_g_dis_atat.edms.atatClient.username"),
            gs.getProperty("x_g_dis_atat.edms.atatClient.password")
        ); // possibly create a programmatic user

		var boundary = "----" + gs.generateGUID() + packageSysId;

		// query parameters
		internalRequest.setQueryParameter("boundary", boundary);
		internalRequest.setQueryParameter("packageId", packageSysId);
		internalRequest.setQueryParameter("attachmentDocSysId", attachmentDocSysId);

		internalRequest.saveResponseBodyAsAttachment(
			'x_g_dis_atat_acquisition_package',
			packageSysId,
			'TestRequirementsChecklist.txt'
		);

		var response = internalRequest.execute();
		var status = response.getStatusCode();
		if (status === 200) {
        return {
			wasCreated: true,
			statusCode: status,
			bodyAttachmentId: response.getResponseAttachmentSysid(),
			generatedBoundary: boundary, 

		};
		}
		return {
			wasCreated: false,
			statusCode: status
		};



    },

    type: 'MultipartHelper'
};
]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>julius.fitzhugh-ctr</sys_created_by>
        <sys_created_on>2022-10-31 06:16:46</sys_created_on>
        <sys_id>35c37d36977611106fa8b4b3f153af94</sys_id>
        <sys_mod_count>15</sys_mod_count>
        <sys_name>MultipartHelper</sys_name>
        <sys_package display_value="ATAT" source="x_g_dis_atat">f600233d1b154d507b782f84604bcb12</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="ATAT">f600233d1b154d507b782f84604bcb12</sys_scope>
        <sys_update_name>sys_script_include_35c37d36977611106fa8b4b3f153af94</sys_update_name>
        <sys_updated_by>julius.fitzhugh-ctr</sys_updated_by>
        <sys_updated_on>2022-11-01 04:20:24</sys_updated_on>
    </sys_script_include>
</record_update>
