<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_g_dis_atat.gInvoicingRequest</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <name>gInvoicingRequest</name>
        <script><![CDATA[function gInvoicingRequest(payload){
	var http_payload;
	try{
		// Outbound REST message
		var request = new sn_ws.RESTMessageV2();
		
		// Request set-up
		request.setEndpoint(payload.endpoint);
		request.setHttpMethod("get");
		request.setLogLevel("all");
		request.setMutualAuth("g-invoicing-mauth");
		
		// Add query parameters
		if(payload.agency_location_code){
			request.setQueryParameter("agencyLocationCode", payload.agency_location_code);
		}
		
		// Make request
		var response = request.execute();
		// Check for errors
		if(response.getStatusCode() != "200"){
			gs.error(response.getStatusCode());
			gs.error(response.getBody());
			var errorMessage = "Error: " + response.getStatusCode() + " " + response.getBody() + " response, no XML retrieved";
			http_payload = {
				body: response.getBody(),
				status_code: response.getStatusCode(),
				headers: response.getAllHeaders(),
				error: errorMessage
			};
			return http_payload;
			
		}
		http_payload = {
			body: response.getBody(),
			status_code: response.getStatusCode(),
			headers: response.getAllHeaders(),
		};
		return http_payload;
	}
	catch(error){
		gs.error("Internal SNOW error => " + error);
		gs.error("Error Stack => " + error.stack);
	}
}]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>zach.clark</sys_created_by>
        <sys_created_on>2022-07-14 15:26:59</sys_created_on>
        <sys_id>2a6c123f1b2091107c458623604bcbe3</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>gInvoicingRequest</sys_name>
        <sys_package display_value="ATAT" source="x_g_dis_atat">f600233d1b154d507b782f84604bcb12</sys_package>
        <sys_policy/>
        <sys_scope display_value="ATAT">f600233d1b154d507b782f84604bcb12</sys_scope>
        <sys_update_name>sys_script_include_2a6c123f1b2091107c458623604bcbe3</sys_update_name>
        <sys_updated_by>zach.clark</sys_updated_by>
        <sys_updated_on>2022-07-14 15:34:37</sys_updated_on>
    </sys_script_include>
</record_update>
